################################################################
# $Id: Makefile.in,v 1.3 2005/09/30 08:07:52 afrolov Exp $
# Makefile for Scarse data subdirectory
################################################################

SHELL = /bin/sh

PREFIX  = /usr/local

BINDIR  = $(PREFIX)/bin
LIBDIR  = $(PREFIX)/lib
DATADIR = $(PREFIX)/share/cms


INSTALL = install
COMPRESS = gzip -9

VERSION = $(shell cat ../VERSION)


# Targets
.PHONY: all clean distclean install-profiles install-targets install-etc install

all:
	cd profiles; make all

clean:
	cd profiles; make clean

distclean:
	cd profiles; make distclean

install-profiles:
	cd profiles; make install

install-targets:
	echo "Installing calibration targets..."
	$(INSTALL) -d $(DATADIR)
	$(INSTALL) -d $(DATADIR)/targets
	$(INSTALL) -d $(DATADIR)/targets/faust
	$(INSTALL) -d $(DATADIR)/targets/kodak
	$(INSTALL) -d $(DATADIR)/targets/macbeth
	$(INSTALL) -d $(DATADIR)/targets/misc
	$(INSTALL) -m 0644 targets/TARGETS $(DATADIR)/targets
	for FILE in `awk '!/^(#|$$)/ {print "targets/" $$3;}' targets/TARGETS | sort | uniq`; do \
		echo "Installing $$FILE"; \
		$(INSTALL) -m 0644 $$FILE $(DATADIR)/$$FILE; \
		$(COMPRESS) $(DATADIR)/$$FILE; \
	done

install-etc:
	echo "Installing configuration files..."
	$(INSTALL) -d $(DATADIR)
	$(INSTALL) -d $(DATADIR)/etc
	for FILE in etc/*; do \
		echo "Installing $$FILE"; \
		$(INSTALL) -m 0644 $$FILE $(DATADIR)/$$FILE; \
	done

install: install-profiles install-targets install-etc
